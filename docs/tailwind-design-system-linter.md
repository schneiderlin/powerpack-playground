# 如何用自定义 Linter 确保 Tailwind 样式符合设计系统

## 1. 问题背景

随着 AI 编码工具的普及，生成 UI 界面变得前所未有的高效。但这也带来了一个新的问题：**AI 生成的代码缺乏一致的样式规范**。

AI 虽然能快速产出代码，但它不了解你的设计系统。它会根据训练数据中的各种示例"创造"样式，结果就是你的代码库中充满了不规范的 Tailwind 类名。

## 2. AI 生成代码的常见问题

### 2.1 颜色混乱

```clojure
;; AI 可能生成这样的代码
[:div {:class "bg-[#1a2b3c] text-[#ff6b6b]"}]
[:div {:class "bg-blue-500 text-pink-400"}]
[:div {:class "bg-slate-900 text-red-100"}]
```

你的设计系统可能只允许几种主色，但 AI 会随机选择各种颜色。

### 2.2 间距不一致

```clojure
;; 随机的间距值
[:div {:class "p-2 m-4"}]
[:div {:class "p-[12px] m-[16px]"}]
[:div {:class "p-3 m-6"}]
```

没有统一的间距规范，视觉上会显得混乱。

### 2.3 字体大小随意

```clojure
[:h1 {:class "text-xl"}]
[:h1 {:class "text-[24px]"}]
[:h1 {:class "text-2xl"}]
```

字体大小应该只有几个预设的等级。

### 2.4 其他问题

- 阴影值不统一（`shadow-sm`、`shadow-md`、`shadow-[0_4px_6px]`）
- 圆角大小混乱
- 边框颜色不一致
- 透明度随意使用

## 3. 为什么会出现这个问题

AI 模型的训练数据包含了大量的开源代码示例，这些示例来自无数不同的项目，各有各的设计系统。当 AI 生成代码时，它无法自动"知道"你的设计系统规范，只能从它见过的例子中随机选择。

结果就是：
- **视觉不一致**：不同页面的风格差异巨大
- **维护负担**：需要人工检查和修复
- **设计债务**：随着代码增长，问题越来越严重
- **抵消 AI 效率**：本来节省的时间都花在修复样式上了

## 4. 解决方案：自定义 Linter

核心思路很简单：**把你的设计系统变成一份"允许清单"，然后强制 AI 只能使用清单中的值**。

### 4.1 设计系统作为单一数据源

首先，创建一个配置文件，定义允许使用的所有 Tailwind 值：

```yaml
# design-system.yml
colors:
  primary: ["blue-500", "blue-600", "blue-700"]
  secondary: ["slate-500", "slate-600"]
  text: ["slate-900", "slate-600", "slate-400"]

spacing:
  scale: [1, 2, 3, 4, 6, 8]

typography:
  headings: ["text-xl", "text-2xl", "text-3xl"]
  body: ["text-sm", "text-base"]

shadows:
  allowed: ["shadow-sm", "shadow-md", "shadow-lg"]

border-radius:
  allowed: ["rounded", "rounded-lg", "rounded-xl"]
```

这个配置就是你设计系统的"真理源头"。

### 4.2 验证逻辑

写一个简单的工具，扫描代码中的 Tailwind 类名，检查是否都在允许清单中：

```
输入：bg-[#1a2b3c] text-pink-400
验证：❌ bg-[#1a2b3c] 不在允许列表中
      ❌ pink-400 不在允许列表中

输入：bg-blue-500 text-slate-900
验证：✅ 都在允许列表中
```

### 4.3 集成到工作流

这个工具可以集成到多个环节：

- **本地检查**：提交前运行，拦截违规代码
- **CI 检查**：构建失败，强制修复
- **AI Prompt**：把允许清单作为约束传给 AI
- **IDE 插件**：实时提示违规

## 5. 实际效果

### 5.1 AI 生成

AI 生成了一些代码，包含违规的 Tailwind 类。

### 5.2 Linter 拦截

```
❌ bg-[#1a2b3c] → 应该使用 blue-500 / blue-600 / blue-700
❌ text-[#ff6b6b] → 应该使用 text-slate-900 / text-slate-600
❌ p-[12px] → 应该使用 p-1 / p-2 / p-3
```

### 5.3 结果

要么自动修复（替换为允许的值），要么标记为需要人工审查。随着时间的推移，AI 会"学习"到这些约束，生成更规范的代码。

## 6. 最佳实践

### 6.1 从关键开始

不要一开始就覆盖所有样式。优先处理最影响一致性的部分：
- 颜色（主色、辅色、文本色）
- 间距（内边距、外边距）
- 字体大小

### 6.2 逐步扩展

先运行 linter，看看实际有多少违规。然后逐步扩展规则覆盖范围。

### 6.3 保持简单

配置文件应该清晰易懂，团队任何人都能修改。避免过度复杂的规则。

### 6.4 团队参与

让设计师参与定义允许值。确保配置与实际设计文档一致。

## 7. 总结

**问题**：AI 生成的 UI 缺乏一致的样式规范，导致设计债务和维护负担。

**解决方案**：创建自定义 linter，把设计系统定义为允许清单，强制所有代码（包括 AI 生成的）只能使用规范中的值。

**结果**：
- ✅ 视觉一致性显著提升
- ✅ 减少人工修复时间
- ✅ AI 生成质量越来越高
- ✅ 设计系统真正成为约束，而非文档

这个问题是完全可以解决的。用少量时间构建验证工具，就能长期保证 AI 生成代码的质量。
